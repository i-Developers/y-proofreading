/*!
 * y-proofreading 0.0.1
 * Copyright (c) 2019 Technote <technote.space@gmail.com> (https://technote.space)
 * License: GPL-3.0
 */!function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.storeName="y-proofreading",t.START="@@YPROOFREADING/START",t.SET_RESPONSE="@@YPROOFREADING/SET_RESPONSE",t.CLOSE_MODAL="@@YPROOFREADING/CLOSE_MODAL",t.NOTICE_ID="YPROOFREADING_MESSAGE"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.apiFetch=function(e,t){return{type:"API_FETCH",method:e,args:t}},t.apiCancel=function(e){return{type:"API_CANCEL",method:e}},t.dispatch=function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return{type:"DISPATCH",storeKey:e,actionName:t,args:r}},t.select=function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return{type:"SELECT",storeKey:e,selectorName:t,args:r}};var r,a=n(2),o=(r=a)&&r.__esModule?r:{default:r};function s(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}t.default={API_FETCH:function(e){var t=e.method,n=e.args;return window[yproofreading_params.api_class].ajax(t,n).then(function(e){return e},function(){return(new o.default.Deferred).resolve({result:!1}).promise()})},API_CANCEL:function(){var e,t=(e=regeneratorRuntime.mark(function e(t){var n=t.method;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window[yproofreading_params.api_class].abort(n);case 2:case"end":return e.stop()}},e,this)}),function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(a,o){try{var s=t[a](o),i=s.value}catch(e){return void n(e)}if(!s.done)return Promise.resolve(i).then(function(e){r("next",e)},function(e){r("throw",e)});e(i)}("next")})});return function(e){return t.apply(this,arguments)}}(),SELECT:function(e){var t,n=e.storeKey,r=e.selectorName,a=e.args;return(t=wp.data.select(n))[r].apply(t,s(a))},DISPATCH:function(e){var t,n=e.storeKey,r=e.actionName,a=e.args;return(t=wp.data.dispatch(n))[r].apply(t,s(a))}}},function(e,t){e.exports=jQuery},function(e,t,n){"use strict";var r=s(n(4));n(9);var a=n(0),o=s(n(2));function s(e){return e&&e.__esModule?e:{default:e}}var i=wp.element.Fragment,l=wp.editPost.PluginPostStatusInfo,u=wp.components.Button,c=wp.data.dispatch;(0,wp.plugins.registerPlugin)("y-proofreading",{render:function(){return wp.element.createElement(i,null,wp.element.createElement(l,null,wp.element.createElement(i,null,wp.element.createElement("label",{className:"edit-post-post-proofreading__label",htmlFor:"edit-post-post-proofreading__toggle"},yproofreading_params.translate.Proofreading),wp.element.createElement(u,{id:"edit-post-post-proofreading__toggle",type:"button",className:"edit-post-post-proofreading__toggle",onClick:function(){c(a.storeName).start()},isLink:!0},yproofreading_params.translate.Proofreading))),wp.element.createElement(r.default,null))}}),(0,o.default)(function(){(0,o.default)(document).on({mouseenter:function(e){var t=(0,o.default)(this).data("i"),n=(0,o.default)(this).data("text");(0,o.default)("body").append('<div id="tooltips-'+t+'" class="tooltips">'+n+"</div>");var r=(0,o.default)("#tooltips-"+t),a=e.pageX,s=e.pageY;r.css({top:s+14,left:a+14})},mousemove:function(e){var t=(0,o.default)(this).data("i"),n=(0,o.default)("#tooltips-"+t),r=e.pageX,a=e.pageY;n.css({top:a+14,left:r+14})},mouseleave:function(){var e=(0,o.default)(this).data("i");(0,o.default)("#tooltips-"+e).remove()}},".proofreading-item")})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProofreadingModal=f;var r=s(n(5)),a=s(n(6)),o=n(0);function s(e){return e&&e.__esModule?e:{default:e}}var i=wp.components.Modal,l=wp.data,u=l.withSelect,c=l.withDispatch,p=wp.compose.compose,d=wp.i18n.__;function f(e){var t=e.isLoading,n=e.isModalActive,o=e.html,s=e.items,l=e.closeModal;return t||n?wp.element.createElement(i,{className:"edit-post-proofreading-modal",title:yproofreading_params.translate.Proofreading,closeLabel:d("Close"),onRequestClose:l},t&&wp.element.createElement(r.default,null),n&&wp.element.createElement(a.default,{html:o,items:s})):null}t.default=p(u(function(e){return{isLoading:e(o.storeName).isLoading(),isModalActive:e(o.storeName).isModalActive(),html:e(o.storeName).getResultHtml(),items:e(o.storeName).getResultItems()}}),c(function(e){return{closeModal:function(){return e(o.storeName).closeModal()}}}))(f)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return wp.element.createElement("div",{className:"proofreading-spinner"},yproofreading_params.translate["Loading..."],wp.element.createElement(r,null))};var r=wp.components.Spinner},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.html,n=e.items;return wp.element.createElement(s,{className:"proofreading-tab-panel",activeClass:"is-active",tabs:[{name:"contents-tab",title:yproofreading_params.translate["Proofreading contents"],className:"contents-tab proofreading__panel-tab"},{name:"items-tab",title:yproofreading_params.translate["Proofreading info"],className:"items-tab proofreading__panel-tab"}]},function(e){return wp.element.createElement(i,null,"contents-tab"===e.name&&wp.element.createElement(a.default,{html:t}),"items-tab"===e.name&&wp.element.createElement(r.default,{items:n}))})};var r=o(n(7)),a=o(n(8));function o(e){return e&&e.__esModule?e:{default:e}}var s=wp.components.TabPanel,i=wp.element.Fragment},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.items;return wp.element.createElement("div",{className:"proofreading-items"},wp.element.createElement("table",{className:"widefat striped"},wp.element.createElement("tr",null,wp.element.createElement("th",null,yproofreading_params.translate["Target surface"]),wp.element.createElement("th",null,yproofreading_params.translate["Candidates of rephrasing"]),wp.element.createElement("th",null,yproofreading_params.translate["Detail info of indicated word"])),t.length<=0&&wp.element.createElement("tr",null,wp.element.createElement("td",{colSpan:"3"},yproofreading_params.translate["Item not found"])),t.length>0&&t.map(function(e){return wp.element.createElement("tr",null,wp.element.createElement("td",null,e.surface),wp.element.createElement("td",null,e.word),wp.element.createElement("td",null,e.info))})))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.html;return wp.element.createElement("div",{className:"proofreading-contents"},wp.element.createElement("div",{className:"proofreading-contents-html editor-styles-wrapper",dangerouslySetInnerHTML:{__html:t}}))}},function(e,t,n){"use strict";var r=u(n(10)),a=l(n(11)),o=l(n(12)),s=u(n(1)),i=n(0);function l(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function u(e){return e&&e.__esModule?e:{default:e}}(0,wp.data.registerStore)(i.storeName,{reducer:r.default,selectors:a,actions:o,controls:s.default})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isModalActive:!1,loading:!1,response:null},t=arguments[1];switch(t.type){case r.START:if(e.loading)return;return e.loading=!0,e;case r.SET_RESPONSE:return e.response=t.response,e.response.result&&(e.isModalActive=!0),e.loading=!1,e;case r.CLOSE_MODAL:return e.isModalActive=!1,e;default:return e}}},function(e,t,n){"use strict";function r(e){return e.response&&e.response.result}Object.defineProperty(t,"__esModule",{value:!0}),t.isLoading=function(e){return e.loading},t.isCanceled=function(e){return e.canceled},t.isModalActive=function(e){return e.isModalActive},t.isSuccess=r,t.getResultHtml=function(e){return r(e)?e.response.html:null},t.getResultItems=function(e){return r(e)?e.response.items:null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.start=l,t.closeModal=u,t.cancel=c;var r=n(0),a=n(1),o=regeneratorRuntime.mark(l),s=regeneratorRuntime.mark(u),i=regeneratorRuntime.mark(c);function l(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,a.select)(r.storeName,"isLoading");case 2:if(!t.sent){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,{type:r.START};case 6:return t.next=8,(0,a.dispatch)("core/notices","createInfoNotice",yproofreading_params.translate["Loading..."],{id:r.NOTICE_ID});case 8:return t.next=10,(0,a.apiFetch)("proofreading",{sentence:wp.data.select("core/editor").getEditedPostContent()});case 10:return e=t.sent,t.next=13,{type:r.SET_RESPONSE,response:e};case 13:if(!e.result){t.next=18;break}return t.next=16,(0,a.dispatch)("core/notices","createSuccessNotice",e.message,{id:r.NOTICE_ID});case 16:t.next=20;break;case 18:return t.next=20,(0,a.dispatch)("core/notices","createErrorNotice",e.message,{id:r.NOTICE_ID});case 20:case"end":return t.stop()}},o,this)}function u(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,a.select)(r.storeName,"isLoading");case 2:if(!e.sent){e.next=5;break}return e.next=5,c();case 5:return e.next=7,{type:r.CLOSE_MODAL};case 7:return e.next=9,(0,a.dispatch)("core/notices","removeNotice",r.NOTICE_ID);case 9:case"end":return e.stop()}},s,this)}function c(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,a.select)(r.storeName,"isLoading");case 2:if(e.sent){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,(0,a.apiCancel)("proofreading");case 6:case"end":return e.stop()}},i,this)}}]);